<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farm Management Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #f9fafb;
            color: #1f2937;
        }
        .header {
            background-color: #16a34a;
            color: white;
            padding: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .header h1 { font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem; }
        .header p { color: #dcfce7; }
        .nav-tabs {
            background-color: white;
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        .nav-container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            gap: 2rem;
            justify-content: space-between;
            align-items: center;
        }
        .nav-buttons {
            display: flex;
            gap: 2rem;
        }
        .nav-button {
            padding: 1rem 0.5rem;
            border: none;
            border-bottom: 2px solid transparent;
            background: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            color: #6b7280;
        }
        .nav-button:hover { color: #374151; }
        .nav-button.active {
            border-bottom-color: #16a34a;
            color: #16a34a;
        }
        .btn-export {
            background-color: #3b82f6;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            font-weight: 500;
        }
        .btn-export:hover { background-color: #2563eb; }
        .container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 1.5rem;
        }
        .card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .card h2, .card h3 {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        .grid {
            display: grid;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .grid-4 { grid-template-columns: repeat(4, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        @media (max-width: 768px) {
            .grid-4, .grid-3 { grid-template-columns: 1fr; }
        }
        .stat-card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
        .stat-card.green { background-color: #f0fdf4; }
        .stat-card.blue { background-color: #eff6ff; }
        .stat-card.amber { background-color: #fffbeb; }
        .stat-card.purple { background-color: #faf5ff; }
        .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.25rem;
        }
        .stat-value {
            font-size: 1.875rem;
            font-weight: bold;
        }
        .stat-value.green { color: #16a34a; }
        .stat-value.blue { color: #2563eb; }
        .stat-value.amber { color: #d97706; }
        .stat-value.purple { color: #9333ea; }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        input, select {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #16a34a;
            box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.1);
        }
        button.btn-primary {
            background-color: #16a34a;
            color: white;
            padding: 0.5rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
        }
        button.btn-primary:hover { background-color: #15803d; }
        button.btn-danger {
            background-color: #dc2626;
            color: white;
            padding: 0.375rem 0.75rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }
        thead { background-color: #f9fafb; }
        th {
            text-align: left;
            padding: 0.75rem 1rem;
            font-weight: 600;
            border-bottom: 1px solid #e5e7eb;
        }
        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e5e7eb;
        }
        tbody tr:hover { background-color: #f9fafb; }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .badge.green { background-color: #dcfce7; color: #166534; }
        .badge.blue { background-color: #dbeafe; color: #1e40af; }
        .badge.red { background-color: #fee2e2; color: #991b1b; }
        .badge.yellow { background-color: #fef3c7; color: #92400e; }
        .badge.amber { background-color: #ffedd5; color: #9a3412; }
        .badge.purple { background-color: #f3e8ff; color: #6b21a8; }
        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid;
        }
        .alert.warning {
            background-color: #fef3c7;
            border-left-color: #f59e0b;
        }
        .alert.urgent {
            background-color: #fee2e2;
            border-left-color: #dc2626;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .overflow-auto { overflow-x: auto; }
        .save-indicator {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: #16a34a;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .save-indicator.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🌾 Farm Management Dashboard</h1>
        <p>Track your farm operations, livestock, and crops in one place • Data saved automatically</p>
    </div>

    <div class="nav-tabs">
        <div class="nav-container">
            <div class="nav-buttons">
                <button class="nav-button active" onclick="switchTab('overview')">Overview</button>
                <button class="nav-button" onclick="switchTab('poultry')">Poultry</button>
                <button class="nav-button" onclick="switchTab('crops')">Crops</button>
                <button class="nav-button" onclick="switchTab('inputs')">Farm Inputs</button>
            </div>
            <button class="btn-export" onclick="exportData()">📥 Export Data</button>
        </div>
    </div>

    <div class="container">
        <div id="overview-tab" class="tab-content active">
            <div class="grid grid-4">
                <div class="stat-card green">
                    <div class="stat-label">Total Poultry</div>
                    <div class="stat-value green" id="total-poultry">0</div>
                </div>
                <div class="stat-card blue">
                    <div class="stat-label">Total Eggs</div>
                    <div class="stat-value blue" id="total-eggs">0</div>
                </div>
                <div class="stat-card amber">
                    <div class="stat-label">Crop Area</div>
                    <div class="stat-value amber"><span id="total-crop-area">0</span> acres</div>
                </div>
                <div class="stat-card purple">
                    <div class="stat-label">Input Costs</div>
                    <div class="stat-value purple">$<span id="total-inputs-cost">0</span></div>
                </div>
            </div>
            <div id="alerts-section"></div>
        </div>

        <div id="poultry-tab" class="tab-content">
            <div class="card">
                <h2>Add Poultry Record</h2>
                <form id="poultry-form" class="form-grid">
                    <input type="date" id="p-date" required>
                    <select id="p-type" required>
                        <option value="">Select Type</option>
                        <option value="Layers">Layers</option>
                        <option value="Broilers">Broilers</option>
                    </select>
                    <input type="number" id="p-count" placeholder="Bird Count" required>
                    <input type="number" id="p-eggs" placeholder="Eggs Collected">
                    <input type="number" id="p-feed" placeholder="Feed (kg)">
                    <input type="number" id="p-mortality" placeholder="Mortality">
                    <input type="text" id="p-batch" placeholder="Batch Name">
                    <input type="text" id="p-notes" placeholder="Notes">
                    <button type="submit" class="btn-primary">Add Record</button>
                </form>
            </div>
            <div class="card overflow-auto">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th><th>Type</th><th>Batch</th><th>Count</th>
                            <th>Eggs</th><th>Feed</th><th>Mortality</th><th>Notes</th><th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="poultry-table"></tbody>
                </table>
            </div>
        </div>

        <div id="crops-tab" class="tab-content">
            <div class="card">
                <h2>Add Crop Record</h2>
                <form id="crop-form" class="form-grid">
                    <input type="date" id="c-date" required>
                    <input type="text" id="c-name" placeholder="Crop Name" required>
                    <input type="number" id="c-area" placeholder="Area (acres)" required step="0.1">
                    <select id="c-stage">
                        <option value="">Select Stage</option>
                        <option value="Planting">Planting</option>
                        <option value="Growing">Growing</option>
                        <option value="Flowering">Flowering</option>
                        <option value="Harvest">Harvest</option>
                    </select>
                    <input type="text" id="c-activities" placeholder="Activities">
                    <input type="number" id="c-cost" placeholder="Cost ($)" step="0.01">
                    <button type="submit" class="btn-primary">Add Record</button>
                </form>
            </div>
            <div class="card overflow-auto">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th><th>Crop</th><th>Area</th><th>Stage</th>
                            <th>Activities</th><th>Cost</th><th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="crop-table"></tbody>
                </table>
            </div>
        </div>

        <div id="inputs-tab" class="tab-content">
            <div class="card">
                <h2>Add Farm Input</h2>
                <form id="input-form" class="form-grid">
                    <input type="date" id="i-date" required>
                    <select id="i-category" required>
                        <option value="">Category</option>
                        <option value="Fertilizer">Fertilizer</option>
                        <option value="Pesticide">Pesticide</option>
                        <option value="Feed">Feed</option>
                        <option value="Other">Other</option>
                    </select>
                    <input type="text" id="i-name" placeholder="Product Name" required>
                    <input type="number" id="i-qty" placeholder="Quantity" required step="0.01">
                    <input type="text" id="i-unit" placeholder="Unit">
                    <input type="number" id="i-cost" placeholder="Cost ($)" step="0.01">
                    <input type="number" id="i-stock" placeholder="Current Stock" step="0.01">
                    <input type="number" id="i-min" placeholder="Min Stock" step="0.01">
                    <button type="submit" class="btn-primary">Add Input</button>
                </form>
            </div>
            <div class="card overflow-auto">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th><th>Category</th><th>Product</th><th>Qty</th>
                            <th>Unit</th><th>Cost</th><th>Stock</th><th>Status</th><th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="input-table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="save-indicator" class="save-indicator">✓ Data saved</div>

    <script>
        // Load data from localStorage or use defaults
        let poultry = JSON.parse(localStorage.getItem('farmPoultry')) || [
            {id:1,date:'2025-10-01',type:'Layers',count:500,eggs:450,feed:75,mortality:2,batchName:'Batch A',notes:'Regular'}
        ];
        let crops = JSON.parse(localStorage.getItem('farmCrops')) || [
            {id:1,date:'2025-10-01',crop:'Corn',area:5,stage:'Planting',activities:'Seeding',cost:500}
        ];
        let inputs = JSON.parse(localStorage.getItem('farmInputs')) || [
            {id:1,date:'2025-10-01',category:'Fertilizer',name:'NPK',quantity:500,unit:'kg',cost:750,currentStock:150,minStock:200}
        ];

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('farmPoultry', JSON.stringify(poultry));
            localStorage.setItem('farmCrops', JSON.stringify(crops));
            localStorage.setItem('farmInputs', JSON.stringify(inputs));
            
            // Show save indicator
            const indicator = document.getElementById('save-indicator');
            indicator.classList.add('show');
            setTimeout(() => indicator.classList.remove('show'), 2000);
        }

        // Export data as JSON file
        function exportData() {
            const data = {
                poultry: poultry,
                crops: crops,
                inputs: inputs,
                exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `farm-data-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        function render() {
            document.getElementById('total-poultry').textContent = poultry.reduce((s,p)=>s+Number(p.count),0);
            document.getElementById('total-eggs').textContent = poultry.reduce((s,p)=>s+Number(p.eggs),0);
            document.getElementById('total-crop-area').textContent = crops.reduce((s,c)=>s+Number(c.area),0);
            document.getElementById('total-inputs-cost').textContent = inputs.reduce((s,i)=>s+Number(i.cost),0);

            let alerts = inputs.filter(i=>(i.minStock>0 && i.currentStock<i.minStock));
            document.getElementById('alerts-section').innerHTML = alerts.length ? 
                '<div class="card"><h3>⚠️ Low Stock Alerts</h3>' + 
                alerts.map(i=>`<div class="alert ${i.currentStock<=0?'urgent':'warning'}">${i.currentStock<=0?'OUT OF STOCK':'Low Stock'}: ${i.name} (${i.currentStock}/${i.minStock} ${i.unit})</div>`).join('') +
                '</div>' : '';

            document.getElementById('poultry-table').innerHTML = poultry.map(p=>`
                <tr>
                    <td>${p.date}</td>
                    <td><span class="badge ${p.type=='Layers'?'blue':'amber'}">${p.type}</span></td>
                    <td>${p.batchName||'—'}</td>
                    <td>${p.count}</td><td>${p.eggs}</td><td>${p.feed}</td>
                    <td>${p.mortality}</td><td>${p.notes}</td>
                    <td><button class="btn-danger" onclick="deleteItem('poultry',${p.id})">×</button></td>
                </tr>
            `).join('');

            document.getElementById('crop-table').innerHTML = crops.map(c=>`
                <tr>
                    <td>${c.date}</td><td>${c.crop}</td><td>${c.area}</td>
                    <td><span class="badge green">${c.stage}</span></td>
                    <td>${c.activities}</td><td>$${c.cost}</td>
                    <td><button class="btn-danger" onclick="deleteItem('crops',${c.id})">×</button></td>
                </tr>
            `).join('');

            document.getElementById('input-table').innerHTML = inputs.map(i=>{
                let status = 'Good', color = 'green';
                if(i.minStock>0) {
                    if(i.currentStock<=0) { status='OUT'; color='red'; }
                    else if(i.currentStock<i.minStock*0.5) { status='Critical'; color='red'; }
                    else if(i.currentStock<i.minStock) { status='Low'; color='yellow'; }
                }
                return `
                    <tr>
                        <td>${i.date}</td>
                        <td><span class="badge ${i.category=='Fertilizer'?'green':i.category=='Feed'?'yellow':'purple'}">${i.category}</span></td>
                        <td>${i.name}</td><td>${i.quantity}</td><td>${i.unit}</td><td>$${i.cost}</td>
                        <td>${i.currentStock} ${i.unit}</td>
                        <td><span class="badge ${color}">${status}</span></td>
                        <td><button class="btn-danger" onclick="deleteItem('inputs',${i.id})">×</button></td>
                    </tr>
                `;
            }).join('');
        }

        function deleteItem(type, id) {
            if(confirm('Delete this record?')) {
                if(type=='poultry') poultry = poultry.filter(p=>p.id!==id);
                if(type=='crops') crops = crops.filter(c=>c.id!==id);
                if(type=='inputs') inputs = inputs.filter(i=>i.id!==id);
                saveData();
                render();
            }
        }

        document.getElementById('poultry-form').onsubmit = (e) => {
            e.preventDefault();
            poultry.push({
                id:Date.now(), date:document.getElementById('p-date').value,
                type:document.getElementById('p-type').value, count:document.getElementById('p-count').value,
                eggs:document.getElementById('p-eggs').value||0, feed:document.getElementById('p-feed').value||0,
                mortality:document.getElementById('p-mortality').value||0, batchName:document.getElementById('p-batch').value,
                notes:document.getElementById('p-notes').value
            });
            e.target.reset();
            saveData();
            render();
        };

        document.getElementById('crop-form').onsubmit = (e) => {
            e.preventDefault();
            crops.push({
                id:Date.now(), date:document.getElementById('c-date').value,
                crop:document.getElementById('c-name').value, area:document.getElementById('c-area').value,
                stage:document.getElementById('c-stage').value, activities:document.getElementById('c-activities').value,
                cost:document.getElementById('c-cost').value||0
            });
            e.target.reset();
            saveData();
            render();
        };

        document.getElementById('input-form').onsubmit = (e) => {
            e.preventDefault();
            inputs.push({
                id:Date.now(), date:document.getElementById('i-date').value,
                category:document.getElementById('i-category').value, name:document.getElementById('i-name').value,
                quantity:document.getElementById('i-qty').value, unit:document.getElementById('i-unit').value,
                cost:document.getElementById('i-cost').value||0, currentStock:document.getElementById('i-stock').value||0,
                minStock:document.getElementById('i-min').value||0
            });
            e.target.reset();
            saveData();
            render();
        };

        render();
    </script>
</body>
</html>
